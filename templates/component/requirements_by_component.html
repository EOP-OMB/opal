{% extends "base.html" %}
{% load static %}
{% block content %}

  <h1>Component Details</h1>
    <div>Here we will describe how our component will meet the requirements for a number of controls. Start by selecting one or more controls from the dropdown below and then select the specific statements that you are addressing.
        Then enter text describing how the component meets the selected requirements.</div>
<hr>
<form method="post" action="{% url 'component:create_component_statement'  %}" id="requirementsForm"
      data-controls-url="{% url 'catalog:ajax_load_controls' %}"
      data-stmts-url="{%  url 'catalog:ajax_load_statements' %}"
      data-params-url="{% url 'catalog:ajax_load_params' %}" novalidate>
    {% csrf_token %}
    <table class="table-bordered">
        {{ ctrl_form.as_table }}
    </table>
    <br>
    <div id="id_params">{{ param_form | safe }}</div>

    <hr>
    <table class="table-active">
        {{ comp_form.as_table }}
    </table>
    <button type="submit">Save</button>
</form>

  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

  <script>
    $("#id_catalog").change(function () {
      var url = $("#requirementsForm").attr("data-controls-url");  // get the url of the view
      var catalogId = $(this).val();  // get the selected catalog ID from the HTML input

      $.ajax({url: url, data: {'control': catalogId}, success: function (data) {$("#id_controls").html(data);}});});

    $("#id_controls").change(function () {
        var url = $("#requirementsForm").attr("data-stmts-url");  // get the url of the view
        var param_url = $("#requirementsForm").attr("data-params-url");  // get the url of the view
        var controlId = $(this).val();        // get the selected catalog ID from the HTML input

        $.ajax({url: url, data: {'control': controlId}, success: function (data) {$("#id_statements").html(data);}});
        $.ajax({url: param_url, data: {'control': controlId}, success: function (data) {$("#id_params").html(data);}});
    });
  </script>

{% endblock %}