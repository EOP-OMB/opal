{% extends "base.html" %}
{% block sidebar %}
    <ol type="I">
    <li><a href="#system_description">System Description</a></li>
    <li><a href="#system_diagrams">System Diagrams</a></li>
    <li><a href="#information_types">System Information Types</a></li>
    <li><a href="#system_components">System Components</a></li>
    <ol type="1">
    {% for component in object.system_components.all %}
        &nbsp;&nbsp;<li><a href="#system_component:{{ component.id }}">{{ component.title }} ({{ component.component_type }})</a></li>
    {% endfor %}
    </ol>
    <li><a href="#system_controls">System Controls</a></li>
    <ol type="1">
    {% for control in object.controlFamilies %}
        <li><a href="#control:{{ control.id }}">{{ control.nist_control.control_title }}</a></li>
    {% endfor %}
    </ol>
    </ol>
{% endblock %}

{% block content %}
    {% load admin_urls %}
    <h1>{{ object.title }} </h1>
    <br>
    <hr>
    <table>
        <tr style="padding: 10px">
            <td style="padding: 10px"><b>Security Objective Confidentiality: </b>: {{ object.security_objective_confidentiality }}</td>
            <td style="padding: 10px"><b>Security Objective Integrity: </b>: {{ object.security_objective_integrity }}</td>
            <td style="padding: 10px"><b>Security Objective Availability: </b>: {{ object.security_objective_availability }}</td>
        </tr>
    </table>
    <hr>
    <b>Organizational Unit: </b>{{ object.organizational_unit }}<br>
    <b>System Owner: </b>{{ object.get_system_owner | safe }}<br>
    <b>Authorizing Official: </b>{{ object.get_authorizing_official | safe }}<br>
    <b>Information System Security Officer: </b>{{ object.get_information_system_security_officer | safe }}<br>
    <b>Information System Security Manager: </b>{{ object.get_information_system_security_manager | safe }}<br>
    <hr>
    <b>Authorization Date: </b>{{ object.date_authorized | date:'d M Y' }}<br>
    <b>Authorization Decision: </b>{{ object.system_status }}<br>
    <b>Authorization Revocation Date: </b>{{ object.authorization_revocation_date | date:'d M Y' }}<br>
    <b>Authorization Revocation Reason: </b>{{ object.authorization_revocation_reason  }}<br>
    <hr>
    <b>System Operator Type: </b>{{ object.system_operator_type }}<br>
    <b>Public: </b>{{ object.public | yesno:"Yes,No" }}<br>
    <hr>
    <table>
        <tr style="padding: 10px">
            <td style="padding: 10px"><b>System Status</b>: {{ object.system_characteristics.system_status }}</td>
            <td style="padding: 10px"><b>Version</b>: {{ object.version }}</td>
            <td style="padding: 10px"><b>Last Modified</b>: {{ object.lastModified }}</td>
        </tr>
    </table>

    <hr>
    <h2><a href="{% url 'admin:ssp_system_security_plan_change' object.id %}" target="_blank">{{ object.title }} ({{ object.short_name}})</a></h2>
        <h3><a id="system_description">System Description</a></h3>
        <div style="margin-left: 30px">{{ object.desc | safe }}</div>
    <h3><a id="system_diagrams">System Diagrams</a></h3>
        <ul>
            <li><b>Authorization Boundary Diagram: </b>
                <img src="{{ object.authorization_boundary_diagram.attachment.url }}">
            <li><b>Network Architecture Diagram: </b>{{ object.network_architecture_diagram.attachment.url }}
            <li><b>Data Flow Diagram: </b>{{ object.data_flow_diagram.attachment.url }}
        </ul>
    <h3><a id="information_types">System Information Types</a></h3>
        <table border="2" cellpadding="3">
            <tr>
                <th>Information Type </th>
                <th>NIST 800-60 identifier</th>
                <th>Confidentiality</th>
                <th>Integrity</th>
                <th>Availability</th>
            </tr>
        {% for info_type in object.information_types.all %}
            <tr>
                <td><a href="{% url 'admin:ssp_information_type_change' info_type.id %}" target="_blank">{{ info_type.title }}</a></td>
                <td>{{ info_type.short_name }}</td>
                <td>{{ info_type.confidentialityImpact }}</td>
                <td>{{ info_type.integrityImpact }}</td>
                <td>{{ info_type.availabilityImpact }}</td>
            </tr>
        {% endfor %}
        </table>
    <h3><a id="system_components">System Components</a></h3>
        {% for component in object.system_components.all %}
            <h4 style="margin-left: 15px">
                <a href="{% url 'admin:ssp_system_component_change' component.id %}" target="_blank">{{ component.title }} ({{ component.component_type }})</a></a></h4>
                <div style="margin-left: 30px">{{ component.desc | safe }}</div>
        {% endfor %}
    <h3><a id="system_controls">System Controls</a></h3>
        {% for c in object.controls.all %}
            {% with c as object %}
                <a id="control:{{ c.id }}">
                {% include "ssp/system_control_detail.html" %}
            {% endwith %}
            <p></p>
        {% endfor %}
{% endblock %}